【16-B-6】　NoOpsを目指すgumiのインフラ自動化ツール
## 翔泳社紹介ページ
http://event.shoeisha.jp/devsumi/20180215/session/1664/

## 資料

## 気持ち
新技術はカジュアルに導入できる．金持ってるな

## 概要

### gumi ops 4人で
- インフラの構築・更新
- 負荷に応じた　インスタンスの増減
- 一時的な検証環境
- エラートラッカー，ロギング
- 監視通知設定　1200以上の監視

### 自動化はパフォーマンスチューニングに似ている

## NoOps
- オリジナルツールを作れ
- インフラはモジュール化せよ
- インフラ自動化はPaaSを目指せ

## オリジナルツールgdwarf概要
- 実現したいことNoOps -> インフラ構成のコードを書いてgdwarfを実行する．それ以外のopsはゼロにする
- awsコンソール，sshは禁止
- mw設定　awsリソースが相手
	- cli
	- ansible
	- cloud formation
- インタフェース
	- 内部ツールを切り替えられる
	- 配布やciへの組み込みやすさ
- 複数ツールのシームレスなじっっこう
- aws以外のサービスと連携

## ansible誰が実行するの問題
- s3にplaybook
- ec2のユーザ設定でs3から落として実行させる
- bootstrapパターンと呼ばれるもの普通

## aws gcpの接続
- BigQuerryにデータを格納するlambdaを作る

## awsリソースのモジュール化
- cfnテンプレートを環境ごとに作るのは無理
	- よくある組み合わせテンプレートを作理，それを組み合わせる

## コスト
- 環境の用意は破棄を簡単にできるようになった
	- 毎日8時間分使った後は破棄することができる。
- 環境を繋ぎっぱなしではなく、使うときだけ使えるのでコスト削減になった

## 自動化できない，難しいこと
- 緊急，障害対応は速さが第一なので手作業でやる
- apiがないDBオペレーション
- 人の承認が必要なもの　acm/sns

## どうやって作ったか
- go
	- クロスコンパイル　mac windows関係ない
	- シングルバイナリなので配布コスト最小，インストールコスト最小
	- cliツールはgoで作るのがおすすめ
- ansible
	- gumiがpython文化だったから
	- サーバ構築，管理不要
	- rubyならaws officework使ったらいいのでは
- cloudformation
	- terafformはサポート契約を結んでいないのでやめた．
		- どっちが悪いのか発見するのがコスト
	- aws純正のサービスなので追加料金サポートなし
	- 新サービスの対応
	- ChangeSet
		- サーバサイドで共有

- いまyaml手作業でやってるけどweb化する

## あれこれpaasじゃね
- webAPI実装するといいと思う

